# 贡献指南（Contributing）

感谢你为本项目贡献！本指南说明开发流程、测试与文档规范，确保一致性与可维护性。

## 开发流程

- 分支：从 `main` 切出特性分支，命名示例：`feat/xxx`、`fix/xxx`、`docs/xxx`。
- 提交信息：使用动宾短句，必要时在正文写明动机、影响范围与关联 Issue。
- PR 要求：列出变更、测试覆盖、潜在风险与回滚方式；关联文档或设计说明。

## 代码规范

- Rust 版本：对齐 `rust-version`；启用 `cargo fmt` 与 `clippy -D warnings`。
- 命名：遵循可读性优先，避免缩写；公开 API 明确注释。
- 错误处理：使用 `DistributedError` 分类；合理区分可重试与不可重试错误。

## 测试规范

- 测试金字塔：优先单元与属性测试，其次集成与端到端。
- 不变量注释：每个测试文件顶部写明“测试目的/关键不变量”。
- 性能断言：如涉及延迟分布，给出 P50/P95/P99 的期望上界，参考 `distributed/docs/performance/OPTIMIZATION.md`。
- 随机性：固定随机种子并记录到日志，便于复现。

## 文档规范

- 模块文档：使用模块级 `//!` 注释概述设计目标、性质与引用。
- 形式化要点：尽量在 README 中列出不变量、充分/必要条件与引用文献。
- Markdown lints：列表前后保留空行、统一缩进；提交前确保通过文档 lint。
- 交叉引用：在 `observability`/`performance`/`testing` 之间相互链接。

## 变更类型

- 功能：增加或修改模块/公共 API；需补充测试与文档。
- 修复：修复缺陷；附最小复现测试。
- 文档：注释与 README 更新；保持 lint 通过。

## 提交清单（Checklist）

- [ ] 通过 `cargo fmt` 与 `clippy -D warnings`
- [ ] 新增/修改测试，覆盖关键不变量
- [ ] 文档已更新（含引用与交叉链接）
- [ ] 本地 lints（代码/Markdown）通过

谢谢你的贡献！
